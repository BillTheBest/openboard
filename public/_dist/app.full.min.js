require("dotenv").load();var express=require("express"),bodyParser=require("body-parser"),errorHandler=require("errorhandler"),methodOverride=require("method-override"),morgan=require("morgan"),http=require("http"),path=require("path"),ntlm=require("express-ntlm"),db=require("./models"),app=express();app.set("port",process.env.PORT||3e3),app.set("views",__dirname+"/views"),app.set("view engine","jade"),app.use(morgan("dev")),app.use(bodyParser()),app.use(methodOverride()),app.use(express["static"](path.join(__dirname,"development"===process.env.NODE_ENV?"public":"public/_dist"))),"development"===process.env.NODE_ENV?(app.use(errorHandler()),app.use(function(a,b,c){a.ntlm={DomainName:"national",UserName:process.env.DEV_USERNAME||"testUser",Workstation:"stunjelly"},c()})):app.use(ntlm({domain:process.env.LDAP_DOMAIN,domaincontroller:process.env.LDAP_CONTROLLLER})),require("./routes")(app),db.sequelize.sync().complete(function(a){if(a)throw a;http.createServer(app).listen(app.get("port"),function(){console.log("Express server listening on port "+app.get("port"))})});